<%= stylesheet_link_tag 'locations/new' %>
<% form_for(@location) do |f| %>
<%= f.error_messages %>
<br />
<div id="top-panel">
	<div id="left-panel">
		<h1>New Location</h1>
		<br />
		<script type="text/javascript" src="http://www.google.com/jsapi?autoload=%7B%22modules%22%3A%5B%7B%22name%22%3A%22maps%22%2C%22version%22%3A%222%22%7D%5D%7D&amp;key=***REMOVED***">
		</script>
		<script type="text/javascript" src="/javascripts/add_location.js"></script>
		<script type="text/javascript" src="/javascripts/load_location_profile.js"></script>

		<div id="map" style="width: 450px; height: 300px"><center><br /><br /><br /><h3>Loading Map...</h3>
			<br />
			<img src="/images/ajax-loader.gif" alt="Please wait..."/></center></div>
			<b>Search:</b>
			<input id="search" size="30" type="text" value="" onkeypress="return submitEnter(this,event)"/>
			<input type="button" value=" Go! " onclick="showAddress(); return false;"/>
		</div>

		<div id="right-panel">
			<br />
			<br />
			<br />
			<p>
			<%= f.submit '  Add Location  ' %>&nbsp;&nbsp;&nbsp;&nbsp;<input type="button" value="  Cancel  " onclick="window.location.href='<%= locations_path %>'"/>
		</p>
		<p>
			<b><%= label_tag 'lat', 'Latitude:' %></b><br />
			<%= f.text_field :lat, {:onkeypress => " return clearMarkersOnTyping(this,event);", "size" => 20} %>
			<br />
			<b><%= label_tag 'lng', 'Longitude:' %></b><br />
			<%= f.text_field :lng, {:onkeypress => " return clearMarkersOnTyping(this,event);", "size" => 20} %>
			<br />
			<br />
			<br />
			<input type="button" value="  Load Location Profile  " onclick="promptLoad(); return false;"/>
			<br />
			<b><%= label_tag 'location_profile_name', 'Location Type: ' %></b><br />
			<%= text_field_with_auto_complete :location, :location_profile_name, {:size => 30}, 
			{:skip_style => true, :url => location_profiles_path(:text), :method => :get, :param_name => 'search' } %>
			<br />
		</p>
	</div>
</div>
	<div id="message"></div>
	<br />
	<p>
	<%= hidden_field_tag "location[category_ids][]", "" %>
	<%= hidden_field_tag "location[product_ids][]", "" %>
	<table border="1">
		<tr>
			<th><b>Categories</b></th>
			<th><b>Products</b></th>
		</tr>
		<% for category in Category.all %>
			<tr>
				<td><%= check_box_tag "location[category_ids][]", category.id,
					category.locations.include?(@location), { :id => "category_ids_"+ category.id.to_s} %> 
					<b><%=h category.name %></b></td>
				<td>
					<table>
						<tr>
							<th></th>
						</tr>
						<% for product in category.products %>
						<tr>
							<td><%= check_box_tag "location[product_ids][]", 
							product.id, product.locations.include?(@location), { :id => "product_ids_"+ product.id.to_s} %> 
							<b><%=h product.name %></b></td>
						</tr>
						<% end %>
					</table>
				</td>
			</tr>
		<% end %>
	</table>
	<br />
	<br />
	<h3><%= label_tag 'info', 'Additional Information:' %></h3>
	<%= f.text_area :info, {"rows" => 5, "cols" => 60} %>
	
</p>

<% end %>